# ç”¨ Gradio åˆ›å»º demo

ç°åœ¨æˆ‘ä»¬å·²ç»å¯¹è¿ªç»´å¸Œè¯­è¯­éŸ³è¯†åˆ«å¾®è°ƒäº† Whisper æ¨¡å‹ï¼Œè®©æˆ‘ä»¬ç»§ç»­å‰è¿›ï¼Œæ„å»ºä¸€ä¸ª [Gradio](https://gradio.app) demo æ¥å‘ç¤¾åŒºå±•ç¤ºå®ƒï¼

é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ `pipeline()` ç±»åŠ è½½å¾®è°ƒåçš„æ£€æŸ¥ç‚¹â€”â€”è¿™ä¸€ç‚¹æˆ‘ä»¬ä» [é¢„è®­ç»ƒæ¨¡å‹](asr_models) ç« èŠ‚å¼€å§‹å°±éå¸¸ç†Ÿæ‚‰äº†ã€‚
æ‚¨å¯ä»¥æ›´æ”¹ `model_id` ä¸ºæ‚¨åœ¨ Hugging Face Hub ä¸Šå¾®è°ƒæ¨¡å‹çš„å‘½åç©ºé—´ï¼Œæˆ–è€…ä½¿ç”¨é¢„è®­ç»ƒçš„ [Whisper æ¨¡å‹](https://huggingface.co/models?sort=downloads&search=openai%2Fwhisper-) æ¥è¿›è¡Œé›¶æ ·æœ¬è¯­éŸ³è¯†åˆ«ï¼š

```python
from transformers import pipeline

model_id = "sanchit-gandhi/whisper-small-dv"  # æ”¹ä¸ºæ‚¨çš„æ¨¡å‹ id
pipe = pipeline("automatic-speech-recognition", model=model_id)
```

å…¶æ¬¡ï¼Œæˆ‘ä»¬å°†å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°æ¥æ”¶è¾“å…¥éŸ³é¢‘çš„æ–‡ä»¶è·¯å¾„å¹¶å°†å…¶è¾“å…¥ pipelineã€‚åœ¨è¿™é‡Œï¼Œpipeline ä¼šè‡ªåŠ¨åŠ è½½éŸ³é¢‘æ–‡ä»¶ï¼Œ
å°†å…¶é‡é‡‡æ ·åˆ°æ­£ç¡®çš„é‡‡æ ·ç‡ï¼Œå¹¶ä½¿ç”¨æ¨¡å‹è¿è¡Œæ¨ç†ã€‚ç„¶åæˆ‘ä»¬å¯ä»¥ç®€å•åœ°è¿”å›è½¬å†™æ–‡æœ¬ä½œä¸ºå‡½æ•°çš„è¾“å‡ºã€‚
ä¸ºäº†ç¡®ä¿æˆ‘ä»¬çš„æ¨¡å‹å¯ä»¥å¤„ç†ä»»æ„é•¿åº¦çš„éŸ³é¢‘è¾“å…¥ï¼Œæˆ‘ä»¬å°†å¯ç”¨ *åˆ†å—*ï¼Œæ­£å¦‚ [é¢„è®­ç»ƒæ¨¡å‹](asr_models) ç« èŠ‚æ‰€æè¿°çš„ï¼š

```python
def transcribe_speech(filepath):
    output = pipe(
        filepath,
        max_new_tokens=256,
        generate_kwargs={
            "task": "transcribe",
            "language": "sinhalese",
        },  # ä¿®æ”¹æˆæ‚¨å¾®è°ƒè¿‡çš„è¯­è¨€
        chunk_length_s=30,
        batch_size=8,
    )
    return output["text"]
```

æˆ‘ä»¬å°†ä½¿ç”¨ Gradio çš„ [blocks](https://gradio.app/docs/#blocks) åŠŸèƒ½åœ¨æˆ‘ä»¬çš„ demo ä¸­å¯åŠ¨ä¸¤ä¸ªæ ‡ç­¾é¡µï¼šä¸€ä¸ªç”¨äºéº¦å…‹é£è½¬å†™ï¼Œå¦ä¸€ä¸ªç”¨äºæ–‡ä»¶ä¸Šä¼ ã€‚

```python
import gradio as gr

demo = gr.Blocks()

mic_transcribe = gr.Interface(
    fn=transcribe_speech,
    inputs=gr.Audio(sources="microphone", type="filepath"),
    outputs=gr.outputs.Textbox(),
)

file_transcribe = gr.Interface(
    fn=transcribe_speech,
    inputs=gr.Audio(sources="upload", type="filepath"),
    outputs=gr.outputs.Textbox(),
)
```

æœ€åï¼Œæˆ‘ä»¬ä½¿ç”¨åˆšåˆšå®šä¹‰çš„ä¸¤ä¸ª blocks å¯åŠ¨ Gradio demoï¼š

```python
with demo:
    gr.TabbedInterface(
        [mic_transcribe, file_transcribe],
        ["Transcribe Microphone", "Transcribe Audio File"],
    )

demo.launch(debug=True)
```

è¿™å°†å¯åŠ¨ä¸€ä¸ªç±»ä¼¼äºåœ¨ Hugging Face Space ä¸Šè¿è¡Œçš„ Gradio demoï¼š

<iframe src="https://course-demos-whisper-small.hf.space" frameBorder="0" height="450" title="Gradio app" class="container p-0 flex-grow space-iframe" allow="accelerometer; ambient-light-sensor; autoplay; battery; camera; document-domain; encrypted-media; fullscreen; geolocation; gyroscope; layout-animations; legacy-image-formats; magnetometer; microphone; midi; oversized-images; payment; picture-in-picture; publickey-credentials-get; sync-xhr; usb; vr ; wake-lock; xr-spatial-tracking" sandbox="allow-forms allow-modals allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-downloads"></iframe>

å¦‚æœæ‚¨å¸Œæœ›åœ¨ Hugging Face Hub ä¸Šæ‰˜ç®¡æ‚¨çš„ demoï¼Œæ‚¨å¯ä»¥ä½¿ç”¨è¿™ä¸ª Space ä½œä¸ºæ‚¨å¾®è°ƒçš„æ¨¡å‹çš„æ¨¡æ¿ã€‚

ç‚¹å‡»é“¾æ¥å°†æ¨¡æ¿ demo å¤åˆ¶åˆ°æ‚¨çš„è´¦æˆ·ï¼šhttps://huggingface.co/spaces/course-demos/whisper-small?duplicate=true

æˆ‘ä»¬å»ºè®®å°†æ‚¨çš„ Space å‘½åä¸ºä¸æ‚¨çš„å¾®è°ƒæ¨¡å‹ç±»ä¼¼çš„åç§°ï¼ˆä¾‹å¦‚ whisper-small-dv-demoï¼‰å¹¶å°†å¯è§æ€§è®¾ç½®ä¸ºâ€œå…¬å¼€â€ã€‚

å°† Space å¤åˆ¶åˆ°æ‚¨çš„è´¦æˆ·åï¼Œè¯·ç‚¹å‡»â€œFiles and versionsâ€->â€œapp.pyâ€->â€œeditâ€ï¼Œç„¶åæ›´æ”¹æ¨¡å‹æ ‡è¯†ç¬¦ä¸ºæ‚¨çš„å¾®è°ƒæ¨¡å‹ï¼ˆç¬¬6è¡Œï¼‰ã€‚æ»šåŠ¨åˆ°é¡µé¢åº•éƒ¨å¹¶ç‚¹å‡»
â€œCommit changes to mainâ€ï¼Œdemo å°†é‡å¯ï¼Œè¿™æ¬¡ä½¿ç”¨çš„æ˜¯æ‚¨çš„å¾®è°ƒæ¨¡å‹ã€‚æ‚¨å¯ä»¥ä¸æ‚¨çš„æœ‹å‹å’Œå®¶äººåˆ†äº«è¿™ä¸ª demoï¼Œä»¥ä¾¿ä»–ä»¬å¯ä»¥ä½¿ç”¨æ‚¨è®­ç»ƒçš„æ¨¡å‹ï¼

æŸ¥çœ‹æˆ‘ä»¬çš„è§†é¢‘æ•™ç¨‹ï¼Œä»¥æ›´å¥½åœ°äº†è§£å¦‚ä½•å¤åˆ¶ Space ğŸ‘‰ï¸ [YouTube è§†é¢‘](https://www.youtube.com/watch?v=VQYuvl6-9VE)

æˆ‘ä»¬æœŸå¾…åœ¨ Hub ä¸Šçœ‹åˆ°æ‚¨çš„ demosï¼
